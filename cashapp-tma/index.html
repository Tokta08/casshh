<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CashBack Pro | –†–∞–±–æ—á–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</title>
    <script src="https://telegram.org/js/twa.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --success: #2ec4b6;
            --dark: #1d3557;
            --light: #f8f9fa;
            --card-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        
        body {
            background-color: #f0f2f5;
            color: #333;
            min-height: 100vh;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 20px;
            padding-bottom: 80px;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding: 15px 0;
        }
        
        .logo {
            font-size: 22px;
            font-weight: 700;
            color: var(--dark);
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }
        
        .balance-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--card-shadow);
            text-align: center;
        }
        
        .balance-amount {
            font-size: 42px;
            font-weight: 800;
            margin: 15px 0;
            color: var(--dark);
        }
        
        .btn {
            display: inline-block;
            padding: 14px 24px;
            background: var(--primary);
            color: white;
            border-radius: 12px;
            font-weight: 600;
            text-decoration: none;
            border: none;
            cursor: pointer;
            margin-top: 15px;
        }
        
        .shops-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .shop-card {
            background: white;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            box-shadow: var(--card-shadow);
            cursor: pointer;
        }
        
        .shop-icon {
            font-size: 24px;
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .shop-name {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .shop-cashback {
            font-size: 14px;
            color: var(--success);
            font-weight: 700;
        }
        
        .history-item {
            background: white;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: var(--card-shadow);
            display: flex;
            justify-content: space-between;
        }
        
        .transaction-info {
            flex-grow: 1;
        }
        
        .transaction-amount {
            font-weight: 700;
            color: var(--success);
        }
        
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            display: flex;
            justify-content: space-around;
            padding: 15px 0;
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.1);
        }
        
        .nav-item {
            text-align: center;
            color: #6c757d;
            text-decoration: none;
            font-size: 12px;
        }
        
        .nav-icon {
            font-size: 20px;
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">CashBack Pro</div>
            <div class="user-avatar" id="userAvatar">U</div>
        </header>
        
        <div class="balance-card">
            <h2>–í–∞—à –±–∞–ª–∞–Ω—Å</h2>
            <div class="balance-amount" id="balance">0 ‚ÇΩ</div>
            <button class="btn" id="withdrawBtn">–í—ã–≤–µ—Å—Ç–∏ –¥–µ–Ω—å–≥–∏</button>
        </div>
        
        <h2>–ú–∞–≥–∞–∑–∏–Ω—ã —Å –∫–µ—à–±–µ–∫–æ–º</h2>
        <div class="shops-grid" id="shopsGrid">
            <!-- –ú–∞–≥–∞–∑–∏–Ω—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
        </div>
        
        <h2>–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</h2>
        <div id="historyList">
            <!-- –ò—Å—Ç–æ—Ä–∏—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ JS -->
        </div>
    </div>
    
    <div class="bottom-nav">
        <a href="#" class="nav-item">
            <div class="nav-icon"><i class="fas fa-home"></i></div>
            <div>–ì–ª–∞–≤–Ω–∞—è</div>
        </a>
        <a href="#" class="nav-item">
            <div class="nav-icon"><i class="fas fa-store"></i></div>
            <div>–ú–∞–≥–∞–∑–∏–Ω—ã</div>
        </a>
        <a href="#" class="nav-item">
            <div class="nav-icon"><i class="fas fa-history"></i></div>
            <div>–ò—Å—Ç–æ—Ä–∏—è</div>
        </a>
    </div>

    <script>
        // =====================
        // –†–ê–ë–û–ß–ï–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–ï
        // =====================
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        const webApp = Telegram.WebApp;
        
        // –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        webApp.ready();
        webApp.expand();
        webApp.BackButton.show();
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ –∫–Ω–æ–ø–∫–µ "–ù–∞–∑–∞–¥"
        webApp.BackButton.onClick(() => {
            webApp.close();
        });
        
        // –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        let userData = {
            balance: 0,
            history: []
        };
        
        // –ú–∞–≥–∞–∑–∏–Ω—ã —Å –∫–µ—à–±–µ–∫–æ–º
        const shops = [
            { id: 'wb', name: 'Wildberries', cashback: '15%', icon: 'fab fa-windows' },
            { id: 'ozon', name: 'Ozon', cashback: '10%', icon: 'fas fa-shopping-bag' },
            { id: 'aliexpress', name: 'AliExpress', cashback: '8%', icon: 'fab fa-alipay' },
            { id: 'lamoda', name: 'Lamoda', cashback: '12%', icon: 'fas fa-tshirt' },
            { id: 'mvideo', name: '–ú.–í–∏–¥–µ–æ', cashback: '7%', icon: 'fas fa-tv' },
            { id: 'yandex', name: '–Ø–Ω–¥–µ–∫—Å.–ú–∞—Ä–∫–µ—Ç', cashback: '9%', icon: 'fab fa-yandex' }
        ];
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function initUser() {
            if (webApp.initDataUnsafe.user) {
                const user = webApp.initDataUnsafe.user;
                
                // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞–≤–∞—Ç–∞—Ä–∞
                const firstNameLetter = user.first_name ? user.first_name.charAt(0) : 'U';
                document.getElementById('userAvatar').textContent = firstNameLetter;
                
                // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ - —Å —Å–µ—Ä–≤–µ—Ä–∞)
                loadUserData(user.id);
            } else {
                // –î–ª—è –¥–µ–º–æ-—Ä–µ–∂–∏–º–∞
                document.getElementById('balance').textContent = '1,840 ‚ÇΩ';
                renderShops();
                renderHistory([
                    { shop: 'Wildberries', amount: 189, date: '–°–µ–≥–æ–¥–Ω—è, 14:30' },
                    { shop: 'Ozon', amount: 347, date: '–í—á–µ—Ä–∞, 19:45' }
                ]);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∑–∞–≥–ª—É—à–∫–∞)
        function loadUserData(userId) {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç fetch –∫ –≤–∞—à–µ–º—É API
            setTimeout(() => {
                userData = {
                    balance: 1840,
                    history: [
                        { shop: 'Wildberries', amount: 189, date: '–°–µ–≥–æ–¥–Ω—è, 14:30' },
                        { shop: 'Ozon', amount: 347, date: '–í—á–µ—Ä–∞, 19:45' },
                        { shop: '–í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤', amount: -1000, date: '12 –∏—é–ª—è, 16:15' }
                    ]
                };
                
                updateUI();
            }, 500);
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateUI() {
            document.getElementById('balance').textContent = `${userData.balance} ‚ÇΩ`;
            renderShops();
            renderHistory(userData.history);
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–≤
        function renderShops() {
            const shopsGrid = document.getElementById('shopsGrid');
            shopsGrid.innerHTML = '';
            
            shops.forEach(shop => {
                const shopCard = document.createElement('div');
                shopCard.className = 'shop-card';
                shopCard.innerHTML = `
                    <div class="shop-icon"><i class="${shop.icon}"></i></div>
                    <div class="shop-name">${shop.name}</div>
                    <div class="shop-cashback">${shop.cashback}</div>
                `;
                
                shopCard.addEventListener('click', () => {
                    openShop(shop.id);
                });
                
                shopsGrid.appendChild(shopCard);
            });
        }
        
        // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞
        function openShop(shopId) {
            const shop = shops.find(s => s.id === shopId);
            
            webApp.showPopup({
                title: shop.name,
                message: `–ö–µ—à–±–µ–∫: ${shop.cashback}\n\n–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∫–µ—à–±–µ–∫, —Å–æ–≤–µ—Ä—à–∞–π—Ç–µ –ø–æ–∫—É–ø–∫–∏ —á–µ—Ä–µ–∑ –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞.`,
                buttons: [
                    { id: 'open', type: 'default', text: '–û—Ç–∫—Ä—ã—Ç—å –º–∞–≥–∞–∑–∏–Ω' },
                    { type: 'cancel' }
                ]
            }).then(btnId => {
                if (btnId === 'open') {
                    // –û—Ç–∫—Ä—ã–≤–∞–µ–º –º–∞–≥–∞–∑–∏–Ω
                    const shopUrls = {
                        wb: 'https://www.wildberries.ru',
                        ozon: 'https://www.ozon.ru',
                        aliexpress: 'https://aliexpress.ru'
                    };
                    
                    if (shopUrls[shopId]) {
                        webApp.openLink(shopUrls[shopId]);
                    } else {
                        webApp.showAlert('–ú–∞–≥–∞–∑–∏–Ω –±—É–¥–µ—Ç –æ—Ç–∫—Ä—ã—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ');
                    }
                }
            });
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–π
        function renderHistory(transactions) {
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = '';
            
            transactions.forEach(transaction => {
                const item = document.createElement('div');
                item.className = 'history-item';
                
                item.innerHTML = `
                    <div class="transaction-info">
                        <div>${transaction.shop}</div>
                        <div style="font-size: 12px; color: #6c757d;">${transaction.date}</div>
                    </div>
                    <div class="transaction-amount">
                        ${transaction.amount > 0 ? '+' : ''}${transaction.amount} ‚ÇΩ
                    </div>
                `;
                
                historyList.appendChild(item);
            });
        }
        
        // –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤
        document.getElementById('withdrawBtn').addEventListener('click', () => {
            webApp.showPopup({
                title: '–í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤',
                message: '–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤—ã–≤–æ–¥–∞: 500 ‚ÇΩ\n–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–±:',
                buttons: [
                    { id: 'card', type: 'default', text: 'üí≥ –ù–∞ –∫–∞—Ä—Ç—É' },
                    { id: 'wallet', type: 'default', text: 'üëõ –ù–∞ –∫–æ—à–µ–ª–µ–∫' },
                    { type: 'cancel' }
                ]
            }).then(btnId => {
                if (btnId === 'card') {
                    requestWithdrawal('card');
                } else if (btnId === 'wallet') {
                    requestWithdrawal('wallet');
                }
            });
        });
        
        // –ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤
        function requestWithdrawal(method) {
            if (userData.balance < 500) {
                webApp.showAlert('–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤—ã–≤–æ–¥–∞ 500 ‚ÇΩ');
                return;
            }
            
            webApp.showPopup({
                title: '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ',
                message: `–í—ã–≤–æ–¥ ${userData.balance} ‚ÇΩ –Ω–∞ ${method === 'card' ? '–∫–∞—Ä—Ç—É' : '–∫–æ—à–µ–ª–µ–∫'}?`,
                buttons: [
                    { id: 'confirm', type: 'destructive', text: '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å' },
                    { type: 'cancel' }
                ]
            }).then(btnId => {
                if (btnId === 'confirm') {
                    // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ API
                    webApp.showAlert('–ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–≤–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! –°—Ä–µ–¥—Å—Ç–≤–∞ –ø–æ—Å—Ç—É–ø—è—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 3 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π.');
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å
                    userData.balance = 0;
                    updateUI();
                }
            });
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        initUser();
    </script>
</body>
</html>